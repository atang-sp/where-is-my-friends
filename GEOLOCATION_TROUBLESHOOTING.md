# 地理位置功能故障排除指南

## 常见问题及解决方案

### 1. "Timeout expired" 错误

**原因**：
- 浏览器定位服务响应慢
- 网络连接问题
- 设备GPS信号弱

**解决方案**：
- 确保网络连接正常
- 在室外或靠近窗户的地方尝试
- 检查设备的位置服务是否开启
- 等待更长时间（已增加到30秒超时）

### 2. "Location access denied" 错误

**原因**：
- 用户拒绝了位置权限
- 浏览器设置阻止了位置访问

**解决方案**：
- 点击浏览器地址栏左侧的锁定图标
- 将位置权限设置为"允许"
- 刷新页面后重试

### 3. "Location information is unavailable" 错误

**原因**：
- 设备的位置服务被禁用
- GPS信号弱或无信号

**解决方案**：
- 检查设备的位置服务设置
- 确保GPS已开启
- 尝试在室外或开阔地带使用

## 浏览器设置指南

### Chrome
1. 点击地址栏左侧的锁定图标
2. 将"位置"设置为"允许"
3. 刷新页面

### Firefox
1. 点击地址栏左侧的盾牌图标
2. 将"位置"设置为"允许"
3. 刷新页面

### Safari
1. 点击地址栏左侧的锁定图标
2. 将"位置"设置为"允许"
3. 刷新页面

### Edge
1. 点击地址栏左侧的锁定图标
2. 将"位置"设置为"允许"
3. 刷新页面

## 设备设置检查

### Android
1. 设置 → 位置信息
2. 确保位置信息已开启
3. 确保应用有位置权限

### iOS
1. 设置 → 隐私与安全性 → 定位服务
2. 确保定位服务已开启
3. 确保浏览器应用有位置权限

### Windows
1. 设置 → 隐私 → 位置
2. 确保位置服务已开启
3. 确保浏览器有位置权限

### macOS
1. 系统偏好设置 → 安全性与隐私 → 隐私 → 定位服务
2. 确保定位服务已开启
3. 确保浏览器有位置权限

## 测试工具

使用 `test-geolocation.html` 文件来测试地理位置功能：

1. 在浏览器中打开 `test-geolocation.html`
2. 点击"测试地理位置"按钮
3. 查看结果和错误信息

## 技术细节

### 地理位置选项
- `enableHighAccuracy: false` - 使用较低精度但更快的定位
- `timeout: 30000` - 30秒超时
- `maximumAge: 300000` - 缓存5分钟

### 错误代码
- `PERMISSION_DENIED (1)` - 用户拒绝位置访问
- `POSITION_UNAVAILABLE (2)` - 位置信息不可用
- `TIMEOUT (3)` - 请求超时

## 联系支持

如果问题仍然存在，请：
1. 记录错误信息
2. 提供浏览器和操作系统版本
3. 描述具体的错误步骤 